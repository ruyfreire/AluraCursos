{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["ListaNegociacoes","Mensagem","NegociacoesView","MensagemView","NegociacoesService","DateHelper","Bind","Negociacao","NegociacaoController","$","document","querySelector","bind","_inputData","_inputQuantidade","_inputValor","_listaNegociacoes","_mensagem","_ordemAtual","_service","_init","lista","then","negociacoes","forEach","negociacao","adiciona","catch","erro","texto","setInterval","importaNegociacoes","event","preventDefault","_criaNegociacao","cadastra","mensagem","_limparFormulario","importa","listaNegociacoes","coluna","inverteOrdem","ordena","a","b","apaga","esvazia","textoParaData","value","parseInt","focus","negociacaoController","currentInstance"],"mappings":"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","sourcesContent":["import {ListaNegociacoes} from \"../models/ListaNegociacoes\";\r\nimport {Mensagem} from \"../models/Mensagem\";\r\nimport {NegociacoesView} from \"../views/NegociacoesView\";\r\nimport {MensagemView} from \"../views/MensagemView\";\r\nimport {NegociacoesService} from \"../services/NegociacoesService\";\r\nimport {DateHelper} from \"../helpers/DateHelper\";\r\nimport {Bind} from \"../helpers/Bind\";\r\nimport {Negociacao} from \"../models/Negociacao\";\r\n\r\nclass NegociacaoController {\r\n\r\n    constructor () {\r\n\r\n        let $ = document.querySelector.bind(document);\r\n\r\n        this._inputData = $(\"#data\");\r\n        this._inputQuantidade = $(\"#quantidade\");\r\n        this._inputValor = $(\"#valor\");\r\n\r\n\r\n        this._listaNegociacoes = new Bind(\r\n            new ListaNegociacoes(),\r\n            new NegociacoesView( $(\"#tabelaView\") ),\r\n            'adiciona', 'esvazia', 'ordena', 'inverteOrdem');\r\n        \r\n        \r\n        this._mensagem = new Bind(\r\n            new Mensagem(),\r\n            new MensagemView( $(\"#mensagemView\") ),\r\n            'texto');\r\n\r\n        this._ordemAtual = \"\";\r\n        this._service = new NegociacoesService();\r\n        \r\n        this._init();\r\n    }\r\n    \r\n    _init() {\r\n        \r\n        this._service\r\n            .lista()\r\n            .then(negociacoes =>\r\n                negociacoes.forEach(negociacao =>\r\n                    this._listaNegociacoes.adiciona(negociacao)))\r\n            .catch(erro => this._mensagem.texto = erro);\r\n\r\n        \r\n        setInterval(() => this.importaNegociacoes(), 3000)\r\n    }\r\n    \r\n    adiciona(event) {\r\n        \r\n        event.preventDefault();\r\n\r\n        let negociacao = this._criaNegociacao();\r\n\r\n        this._service\r\n            .cadastra(negociacao)\r\n            .then(mensagem => {\r\n                this._listaNegociacoes.adiciona(negociacao);\r\n                this._mensagem.texto = mensagem;\r\n                this._limparFormulario();\r\n            })\r\n            .catch(erro => this._mensagem.texto = erro);\r\n\r\n    }\r\n\r\n    importaNegociacoes() {\r\n\r\n        this._service\r\n            .importa(this._listaNegociacoes.listaNegociacoes)\r\n            .then(negociacoes => {\r\n                negociacoes.forEach(negociacao =>\r\n                    this._listaNegociacoes.adiciona(negociacao));\r\n                this._mensagem.texto = \"Negociações do período importadas\";\r\n            })\r\n            .catch(erro => this._mensagem.texto = erro)\r\n    }\r\n\r\n    ordena(coluna) {\r\n\r\n        if(this._ordemAtual == coluna) this._listaNegociacoes.inverteOrdem();\r\n        else this._listaNegociacoes.ordena((a, b) => a[coluna] - b[coluna]);\r\n\r\n        this._ordemAtual = coluna;\r\n    }\r\n    \r\n    apaga() {\r\n\r\n        this._service\r\n            .apaga()\r\n            .then(mensagem => {\r\n                this._listaNegociacoes.esvazia();\r\n                this._mensagem.texto = mensagem;\r\n            })\r\n            .catch(erro => this._mensagem.texto = erro);\r\n    }\r\n\r\n    _criaNegociacao() {\r\n        \r\n        return new Negociacao(\r\n            DateHelper.textoParaData(this._inputData.value),\r\n            parseInt(this._inputQuantidade.value),\r\n            parseInt(this._inputValor.value));\r\n    }\r\n\r\n    _limparFormulario() {\r\n\r\n        this._inputData.value = \"\";\r\n        this._inputData.focus();\r\n        this._inputQuantidade.value = 1;\r\n        this._inputValor.value = 0.0;\r\n    }\r\n    \r\n}\r\n\r\nlet negociacaoController = new NegociacaoController();\r\n\r\nexport function currentInstance() {\r\n\r\n    return negociacaoController;\r\n\r\n}"],"file":"NegociacaoController.js"}